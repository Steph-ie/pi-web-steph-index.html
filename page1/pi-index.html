<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Pi</title>
  <style>
    :root {
      --bg: #0f061a;
      --panel: rgba(255,255,255,0.06);
      --panel2: rgba(255,255,255,0.09);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.72);
      --muted2: rgba(255,255,255,0.55);
      --line: rgba(255,255,255,0.12);
      --purple: #a855f7;
      --purple2: #7c3aed;
      --pink: #f472b6;
      --good: #34d399;
      --bad: #fb7185;
      --shadow: 0 20px 50px rgba(0,0,0,0.45);
      --radius: 22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(900px 500px at 20% 10%, rgba(168,85,247,0.22), transparent 60%),
        radial-gradient(700px 450px at 80% 20%, rgba(244,114,182,0.16), transparent 55%),
        radial-gradient(900px 600px at 50% 110%, rgba(124,58,237,0.22), transparent 60%),
        linear-gradient(180deg, #07020d, var(--bg));
      min-height: 100vh;
    }
    a { color: #c4b5fd; text-decoration: none; }
    a:hover { text-decoration: underline; }

    header {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(12px);
      background: rgba(15,6,26,0.55);
      border-bottom: 1px solid var(--line);
    }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 18px 18px; }
    .topbar {
      display: flex;
      gap: 14px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      user-select: none;
    }
    .logo {
      width: 42px; height: 42px;
      border-radius: 14px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18), transparent 60%),
        linear-gradient(135deg, rgba(168,85,247,0.95), rgba(124,58,237,0.8));
      box-shadow: 0 10px 30px rgba(124,58,237,0.25);
      display: grid;
      place-items: center;
      font-weight: 800;
    }
    .brand h1 {
      font-size: 18px;
      line-height: 1.1;
      margin: 0;
      letter-spacing: 0.2px;
    }
    .brand .tag { font-size: 12px; color: var(--muted2); margin-top: 3px; }
    nav {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    .btn {
      border: 1px solid var(--line);
      color: var(--text);
      background: rgba(255,255,255,0.06);
      padding: 10px 12px;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 650;
      font-size: 13px;
      transition: transform 0.06s ease, background 0.2s ease, border-color 0.2s ease;
      user-select: none;
    }
    .btn:hover { background: rgba(168,85,247,0.14); border-color: rgba(168,85,247,0.35); }
    .btn:active { transform: translateY(1px); }
    .btn.primary {
      background: linear-gradient(135deg, rgba(168,85,247,0.95), rgba(124,58,237,0.85));
      border-color: rgba(168,85,247,0.5);
      box-shadow: 0 10px 25px rgba(124,58,237,0.25);
    }
    .btn.primary:hover {
      background: linear-gradient(135deg, rgba(168,85,247,1), rgba(124,58,237,0.95));
    }
    .pill {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.05);
      color: var(--muted);
      font-size: 12px;
    }
    main { padding: 26px 0 70px; }
    .hero {
      display: grid;
      grid-template-columns: 1.35fr 0.65fr;
      gap: 16px;
      align-items: stretch;
    }
    @media (max-width: 920px) {
      .hero { grid-template-columns: 1fr; }
    }
    .card {
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.06);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
    }
    .card.soft {
      background: rgba(255,255,255,0.045);
      box-shadow: none;
    }
    .headline {
      font-size: 34px;
      line-height: 1.08;
      margin: 0 0 10px;
      letter-spacing: -0.5px;
    }
    .subhead {
      margin: 0 0 14px;
      color: var(--muted);
      font-size: 14.5px;
      line-height: 1.55;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
      margin-top: 16px;
    }
    .tile {
      grid-column: span 4;
      padding: 16px;
      border: 1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,0.05);
      cursor: pointer;
      transition: transform 0.12s ease, border-color 0.2s ease, background 0.2s ease;
      min-height: 112px;
    }
    .tile:hover {
      transform: translateY(-2px);
      background: rgba(168,85,247,0.12);
      border-color: rgba(168,85,247,0.35);
    }
    .tile h3 {
      margin: 0 0 6px;
      font-size: 15px;
      letter-spacing: 0.1px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .tile p {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }
    @media (max-width: 920px) { .tile { grid-column: span 6; } }
    @media (max-width: 560px) { .tile { grid-column: span 12; } }
    .icon {
      width: 26px; height: 26px; border-radius: 10px;
      background: rgba(168,85,247,0.18);
      border: 1px solid rgba(168,85,247,0.25);
      display: grid; place-items: center;
      font-size: 14px;
    }

    .view { display: none; animation: fadeIn 0.18s ease; }
    .view.active { display: block; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .sectionTitle {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .sectionTitle h2 { margin: 0; font-size: 22px; letter-spacing: -0.2px; }
    .sectionTitle .hint { color: var(--muted2); font-size: 12.5px; }

    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    @media (max-width: 920px) { .row { grid-template-columns: 1fr; } }

    input, select, textarea {
      width: 100%;
      background: rgba(0,0,0,0.25);
      border: 1px solid var(--line);
      color: var(--text);
      border-radius: 14px;
      padding: 11px 12px;
      outline: none;
      font-size: 14px;
    }
    input:focus, select:focus, textarea:focus {
      border-color: rgba(168,85,247,0.55);
      box-shadow: 0 0 0 4px rgba(168,85,247,0.12);
    }
    label { display: block; font-size: 12px; color: var(--muted); margin: 10px 0 6px; }
    .mini { font-size: 12px; color: var(--muted2); margin-top: 6px; line-height: 1.45; }
    .mono { font-family: var(--mono); font-size: 13px; line-height: 1.55; color: rgba(255,255,255,0.88); white-space: pre-wrap; word-break: break-word; }
    pre.mono {
      padding: 14px; border-radius: 16px; background: rgba(0,0,0,0.28);
      border: 1px solid var(--line); max-height: 320px; overflow: auto;
    }
    .kpi { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 12px; }
    @media (max-width: 560px) { .kpi { grid-template-columns: 1fr; } }
    .kpi .box { border: 1px solid var(--line); border-radius: 18px; background: rgba(255,255,255,0.05); padding: 12px; }
    .kpi .box .big { font-family: var(--mono); font-size: 16px; margin: 4px 0 2px; }
    .kpi .box .small { color: var(--muted2); font-size: 12px; }

    canvas { width: 100%; height: 280px; background: rgba(0,0,0,0.25); border: 1px solid var(--line); border-radius: 18px; display: block; }

    .gallery { display: grid; grid-template-columns: repeat(12, 1fr); gap: 12px; }
    .gcard { grid-column: span 4; border: 1px solid var(--line); border-radius: 18px; background: rgba(255,255,255,0.05); overflow: hidden; }
    .gcard .pad { padding: 12px; }
    .gcard h4 { margin: 0 0 6px; font-size: 14px; }
    .gcard p { margin: 0; color: var(--muted); font-size: 12.5px; line-height: 1.5; }
    .gcard svg {
      width: 100%; height: 120px; display: block;
      background:
        radial-gradient(260px 160px at 30% 30%, rgba(168,85,247,0.28), transparent 65%),
        radial-gradient(280px 160px at 75% 55%, rgba(244,114,182,0.16), transparent 60%),
        rgba(0,0,0,0.22);
      border-bottom: 1px solid var(--line);
    }
    @media (max-width: 920px) { .gcard { grid-column: span 6; } }
    @media (max-width: 560px) { .gcard { grid-column: span 12; } }

    .toast {
      position: fixed; bottom: 18px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.7); border: 1px solid rgba(255,255,255,0.12);
      padding: 10px 12px; border-radius: 999px; font-size: 13px; color: rgba(255,255,255,0.9);
      backdrop-filter: blur(8px); opacity: 0; pointer-events: none;
      transition: opacity 0.18s ease, transform 0.18s ease; z-index: 99;
    }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(-2px); }
    footer { color: var(--muted2); font-size: 12px; padding-top: 18px; border-top: 1px solid var(--line); margin-top: 26px; }
  </style>
</head>
<body>
  <header>
    <div class="wrap topbar">
      <div class="brand" role="button" tabindex="0" onclick="go('home')">
        <div class="logo">œÄ</div>
        <div>
          <h1>Pi</h1>
          <div class="tag">A purple playground for the most famous constant üü£</div>
        </div>
      </div>
      <nav aria-label="Primary navigation">
        <button class="btn" onclick="go('what')">What is œÄ</button>
        <button class="btn" onclick="go('calculate')">Calculate</button>
        <button class="btn" onclick="go('apps')">Applications</button>
        <button class="btn" onclick="go('shapes')">Shapes</button>
        <button class="btn" onclick="go('papers')">Papers</button>
        <button class="btn primary" onclick="go('games')">Games</button>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section id="view-home" class="view active" aria-label="Home">
      <div class="hero">
        <div class="card">
          <div class="pill">œÄ ‚âà 3.141592653589793‚Ä¶ <span style="color:var(--muted2)">and it never ends</span></div>
          <h2 class="headline">Welcome to Pi.</h2>
          <p class="subhead">
            Pi is the ratio of a circle‚Äôs circumference to its diameter. Simple sentence, bottomless rabbit hole.
            This site is a guided tour with calculators, visuals, shapes, papers, and games.
          </p>
          <div class="grid" role="list">
            <div class="tile" role="listitem" onclick="go('what')">
              <h3><span class="icon">‚ë†</span> What is œÄ</h3>
              <p>Definition, history bites, and a big chunk of digits you can copy.</p>
            </div>
            <div class="tile" role="listitem" onclick="go('calculate')">
              <h3><span class="icon">‚ë°</span> Calculate</h3>
              <p>Try real methods: circumference, Monte Carlo darts, and a classic series.</p>
            </div>
            <div class="tile" role="listitem" onclick="go('apps')">
              <h3><span class="icon">‚ë¢</span> Applications</h3>
              <p>Visual cards + explanations of how œÄ shows up in the real world.</p>
            </div>
            <div class="tile" role="listitem" onclick="go('shapes')">
              <h3><span class="icon">‚ë£</span> Shapes</h3>
              <p>Curves that whisper œÄ: circles, spirals, roses, Lissajous, cycloids.</p>
            </div>
            <div class="tile" role="listitem" onclick="go('papers')">
              <h3><span class="icon">‚ë§</span> Papers</h3>
              <p>A mini reading shelf of pi computation/history links you can update later.</p>
            </div>
            <div class="tile" role="listitem" onclick="go('games')">
              <h3><span class="icon">üéÆ</span> Games</h3>
              <p>Digit sprint, quiz, and a small memory game to glue œÄ into your brain.</p>
            </div>
          </div>
        </div>

        <div class="card soft">
          <div class="sectionTitle">
            <h2>Quick tools</h2>
            <div class="hint">tiny, instant, useful</div>
          </div>

          <label for="quickExpr">Quick calculator</label>
          <input id="quickExpr" placeholder="Example: 2*pi*3 or 22/7" />
          <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
            <button class="btn" onclick="quickCalc()">Compute</button>
            <button class="btn" onclick="insertPi()">Insert œÄ</button>
          </div>
          <div class="mini">Supports + - * / ( ) and constants: <span class="mono">pi</span>, <span class="mono">e</span>.</div>

          <div class="kpi" aria-label="Quick stats">
            <div class="box">
              <div class="small">œÄ to 15 digits</div>
              <div class="big" id="kpiPi">3.14159265358979</div>
            </div>
            <div class="box">
              <div class="small">22/7 error</div>
              <div class="big" id="kpiErr">‚âà 0.00126449</div>
            </div>
            <div class="box">
              <div class="small">œÑ = 2œÄ</div>
              <div class="big" id="kpiTau">6.28318530717959</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="view-what" class="view" aria-label="What is Pi">
      <div class="card">
        <div class="sectionTitle">
          <h2>What is œÄ?</h2>
          <div class="hint">definition + digits + a tiny history</div>
        </div>

        <div class="row">
          <div>
            <p class="subhead">
              <b>œÄ</b> (pi) is the constant ratio:
              <span class="mono">œÄ = circumference / diameter</span>.
              It appears in circles, waves, probability, complex numbers, and any place where ‚Äúturning‚Äù happens.
            </p>

            <div class="kpi">
              <div class="box"><div class="small">Circle fact</div><div class="big"><span class="mono">C = œÄ¬∑d</span></div></div>
              <div class="box"><div class="small">Area fact</div><div class="big"><span class="mono">A = œÄ¬∑r¬≤</span></div></div>
              <div class="box"><div class="small">Radians</div><div class="big"><span class="mono">180¬∞ = œÄ</span></div></div>
            </div>

            <div style="margin-top:14px;">
              <label for="digitSearch">Search within digits</label>
              <input id="digitSearch" placeholder="Type a short pattern, e.g. 1415 or 2718"/>
              <div class="mini" id="digitSearchResult"></div>
              <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
                <button class="btn" onclick="copyDigits()">Copy digits</button>
                <button class="btn" onclick="highlightDigits()">Find pattern</button>
                <button class="btn" onclick="go('calculate')">Next: calculate œÄ ‚Üí</button>
              </div>
            </div>
          </div>

          <div>
            <div class="pill">Digits (a lot, but still only a splash)</div>
            <pre class="mono" id="digitsBox">3.14159265358979323846264338327950288419716939937510
58209749445923078164062862089986280348253421170679
82148086513282306647093844609550582231725359408128
48111745028410270193852110555964462294895493038196
44288109756659334461284756482337867831652712019091
45648566923460348610454326648213393607260249141273
72458700660631558817488152092096282925409171536436
78925903600113305305488204665213841469519415116094
33057270365759591953092186117381932611793105118548
07446237996274956735188575272489122793818301194912
98336733624406566430860213949463952247371907021798
60943702770539217176293176752384674818467669405132
00056812714526356082778577134275778960917363717872
14684409012249534301465495853710507922796892589235
42019956112129021960864034418159813629774771309960
51870721134999999837297804995105973173281609631859
50244594553469083026425223082533446850352619311881
71010003137838752886587533208381420617177669147303
59825349042875546873115956286388235378759375195778
18577805321712268066130019278766111959092164201989
38095257201065485863278865936153381827968230301952</pre>
            <div class="mini">
              Fun fact: œÄ is <b>irrational</b> (non-repeating, non-terminating) and also <b>transcendental</b>.
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="view-calculate" class="view" aria-label="Calculate Pi">
      <div class="card">
        <div class="sectionTitle">
          <h2>Calculate œÄ</h2>
          <div class="hint">three methods + a normal calculator</div>
        </div>

        <div class="row">
          <div class="card soft">
            <h3 style="margin:0 0 6px;">1) From a circle (measurement)</h3>
            <p class="subhead" style="margin-top:0;">
              If you know a circle‚Äôs radius <span class="mono">r</span> and circumference <span class="mono">C</span>,
              then <span class="mono">œÄ = C / (2r)</span>.
            </p>

            <label>Radius (r)</label>
            <input id="rIn" type="number" step="any" value="1"/>
            <label>Circumference (C)</label>
            <input id="cIn" type="number" step="any" value="6.283185307179586"/>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="calcFromCircle()">Compute œÄ</button>
              <button class="btn" onclick="fillPerfectCircle()">Set perfect C = 2œÄr</button>
            </div>
            <pre class="mono" id="circleOut" style="margin-top:12px; padding:12px; border-radius:16px; border:1px solid var(--line); background: rgba(0,0,0,0.25);">œÄ ‚âà ...</pre>
          </div>

          <div class="card soft">
            <h3 style="margin:0 0 6px;">2) Monte Carlo ‚Äúdartboard‚Äù</h3>
            <p class="subhead" style="margin-top:0;">
              Toss random points into a square. Count what lands inside the quarter-circle.
              <span class="mono">œÄ ‚âà 4¬∑(inside / total)</span>.
            </p>

            <label>Points per run</label>
            <input id="mcN" type="number" step="1" value="2000"/>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="mcRun()">Run</button>
              <button class="btn" onclick="mcReset()">Reset</button>
            </div>
            <canvas id="mcCanvas" width="700" height="280" aria-label="Monte Carlo canvas"></canvas>
            <div class="mini" id="mcOut"></div>
          </div>
        </div>

        <div class="row" style="margin-top:14px;">
          <div class="card soft">
            <h3 style="margin:0 0 6px;">3) Leibniz series (slow but iconic)</h3>
            <p class="subhead" style="margin-top:0;">
              <span class="mono">œÄ/4 = 1 - 1/3 + 1/5 - 1/7 + ‚Ä¶</span>.
            </p>
            <label>Terms</label>
            <input id="leibTerms" type="number" step="1" value="20000"/>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="leibCompute()">Compute</button>
              <button class="btn" onclick="leibAuto()">Auto (increase)</button>
            </div>
            <pre class="mono" id="leibOut" style="margin-top:12px; padding:12px; border-radius:16px; border:1px solid var(--line); background: rgba(0,0,0,0.25);">œÄ ‚âà ...</pre>
          </div>

          <div class="card soft">
            <h3 style="margin:0 0 6px;">Bonus: calculator</h3>
            <label>Expression</label>
            <input id="calcExpr" placeholder="Example: (3*pi/4)^2 + 1 (use * and / only)"/>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="calcEval()">Evaluate</button>
              <button class="btn" onclick="calcInsert('calcExpr')">Insert œÄ</button>
              <button class="btn" onclick="calcClear()">Clear</button>
            </div>
            <pre class="mono" id="calcOut" style="margin-top:12px; padding:12px; border-radius:16px; border:1px solid var(--line); background: rgba(0,0,0,0.25);">result = ...</pre>
          </div>
        </div>
      </div>
    </section>

    <section id="view-apps" class="view" aria-label="Applications">
      <div class="card">
        <div class="sectionTitle">
          <h2>Applications</h2>
          <div class="hint">visual cards + interactives</div>
        </div>

        <p class="subhead">
          Pi shows up whenever circles, periodic motion, rotations, Fourier analysis, and probability enter the room.
        </p>

        <div class="gallery">
          <div class="gcard">
            <svg viewBox="0 0 600 240" role="img" aria-label="Engineering">
              <circle cx="160" cy="120" r="70" fill="none" stroke="rgba(255,255,255,0.65)" stroke-width="10"/>
              <circle cx="160" cy="120" r="18" fill="rgba(168,85,247,0.55)"/>
              <circle cx="360" cy="125" r="95" fill="none" stroke="rgba(255,255,255,0.35)" stroke-width="10"/>
              <path d="M360 30 L360 220" stroke="rgba(244,114,182,0.8)" stroke-width="4" opacity="0.8"/>
              <path d="M265 125 L455 125" stroke="rgba(244,114,182,0.8)" stroke-width="4" opacity="0.8"/>
              <text x="22" y="214" fill="rgba(255,255,255,0.75)" font-size="22" font-family="ui-monospace">C = 2œÄr</text>
            </svg>
            <div class="pad">
              <h4>Engineering</h4>
              <p>Gears, wheels, pipes, bearings. Arc length and rotation are basically œÄ‚Äôs hometown.</p>
            </div>
          </div>

          <div class="gcard">
            <svg viewBox="0 0 600 240" role="img" aria-label="Signals">
              <path d="M0 150 C 60 90, 120 210, 180 150 C 240 90, 300 210, 360 150 C 420 90, 480 210, 540 150 C 570 120, 590 110, 600 115"
                    fill="none" stroke="rgba(168,85,247,0.9)" stroke-width="8"/>
              <text x="22" y="64" fill="rgba(255,255,255,0.75)" font-size="22" font-family="ui-monospace">sin(2œÄft)</text>
            </svg>
            <div class="pad">
              <h4>Signals & sound</h4>
              <p>Sine waves, Fourier transforms, oscillations. One cycle is 2œÄ radians.</p>
            </div>
          </div>

          <div class="gcard">
            <svg viewBox="0 0 600 240" role="img" aria-label="Probability">
              <rect x="60" y="40" width="180" height="180" rx="18" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.35)" stroke-width="3"/>
              <path d="M60 220 A 180 180 0 0 1 240 40" fill="none" stroke="rgba(244,114,182,0.85)" stroke-width="10"/>
              <text x="290" y="98" fill="rgba(255,255,255,0.75)" font-size="22" font-family="ui-monospace">œÄ ‚âà 4¬∑inside/total</text>
            </svg>
            <div class="pad">
              <h4>Probability</h4>
              <p>Monte Carlo methods can estimate œÄ from random samples and geometry.</p>
            </div>
          </div>
        </div>

        <div class="row" style="margin-top:14px;">
          <div class="card soft">
            <h3 style="margin:0 0 6px;">Virtual: sine wave</h3>
            <canvas id="waveCanvas" width="700" height="280"></canvas>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="toggleWave()">Play / Pause</button>
            </div>
          </div>

          <div class="card soft">
            <h3 style="margin:0 0 6px;">Virtual: unit circle angle</h3>
            <label>Angle (radians)</label>
            <input id="angleSlider" type="range" min="-3.14159" max="3.14159" step="0.001" value="1.047"/>
            <div class="mini" id="angleReadout"></div>
            <canvas id="unitCanvas" width="700" height="280"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id="view-shapes" class="view" aria-label="Shapes">
      <div class="card">
        <div class="sectionTitle">
          <h2>Shapes</h2>
          <div class="hint">curves + sliders</div>
        </div>

        <div class="row">
          <div class="card soft">
            <label>Curve</label>
            <select id="curveSelect" onchange="drawCurve()">
              <option value="circle">Circle (unit)</option>
              <option value="archSpiral">Archimedean spiral</option>
              <option value="rose">Rose curve (r = cos(kŒ∏))</option>
              <option value="lissajous">Lissajous</option>
              <option value="cycloid">Cycloid</option>
            </select>

            <label>Parameter</label>
            <input id="curveParam" type="range" min="1" max="9" step="1" value="4" oninput="drawCurve()"/>
            <div class="mini" id="curveParamReadout"></div>

            <label>Phase Œ¥ (Lissajous)</label>
            <input id="curvePhase" type="range" min="0" max="6.283" step="0.001" value="1.571" oninput="drawCurve()"/>
            <div class="mini" id="curvePhaseReadout"></div>
          </div>

          <div class="card soft">
            <canvas id="shapeCanvas" width="700" height="280"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id="view-papers" class="view" aria-label="Papers">
      <div class="card">
        <div class="sectionTitle">
          <h2>Papers & further reading</h2>
          <div class="hint">starter shelf</div>
        </div>

        <div class="row">
          <div class="card soft">
            <ol style="margin:0; padding-left:18px; color: var(--muted); line-height:1.65;">
              <li><a href="https://www.davidhbailey.com/dhbpapers/pi-quest.pdf" target="_blank" rel="noreferrer">The Quest for Pi (Bailey et al., 1996/1997)</a></li>
              <li><a href="https://plouffe.fr/simon/articles/Miraculous.pdf" target="_blank" rel="noreferrer">The Miraculous Bailey‚ÄìBorwein‚ÄìPlouffe Pi Algorithm (Plouffe, 1995)</a></li>
              <li><a href="https://bellard.org/pi/pi2700e9/pipcrecord.pdf" target="_blank" rel="noreferrer">Computation of 2700 billion digits of Pi (Bellard, 2009)</a></li>
              <li><a href="https://arxiv.org/abs/1809.00533" target="_blank" rel="noreferrer">A detailed proof of the Chudnovsky formula (Milla, 2018)</a></li>
            </ol>
          </div>

          <div class="card soft">
            <h3 style="margin:0 0 10px;">Update box</h3>
            <textarea id="paperNotes" rows="9" placeholder="Add notes here..."></textarea>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="saveNotes()">Save notes</button>
              <button class="btn" onclick="loadNotes()">Load notes</button>
              <button class="btn" onclick="clearNotes()">Clear</button>
            </div>
            <div class="mini">Stored locally in your browser (localStorage).</div>
          </div>
        </div>

        <footer>
          Last generated: <span id="genDate"></span>
        </footer>
      </div>
    </section>

    <section id="view-games" class="view" aria-label="Games">
      <div class="card">
        <div class="sectionTitle">
          <h2>Games</h2>
          <div class="hint">digit sprint + quiz + memory</div>
        </div>

        <div class="row">
          <div class="card soft">
            <h3 style="margin:0 0 6px;">Digit Sprint</h3>
            <div class="pill">Target: <span class="mono" id="sprintTarget">14159265358979323846‚Ä¶</span></div>
            <label>Type here</label>
            <input id="sprintIn" placeholder="Start typing: 14159..." oninput="sprintCheck()"/>
            <div class="kpi">
              <div class="box"><div class="small">Streak</div><div class="big" id="sprintScore">0</div></div>
              <div class="box"><div class="small">Best</div><div class="big" id="sprintBest">0</div></div>
              <div class="box"><div class="small">Status</div><div class="big" id="sprintStatus">üôÇ</div></div>
            </div>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="sprintReset()">Reset</button>
              <button class="btn" onclick="sprintNew()">New target chunk</button>
            </div>
          </div>

          <div class="card soft">
            <h3 style="margin:0 0 6px;">Quick Quiz</h3>
            <div id="quizBox" class="mono" style="padding: 12px; border-radius:16px; border:1px solid var(--line); background: rgba(0,0,0,0.25);"></div>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="quizStart()">Start / Restart</button>
              <button class="btn" onclick="quizSubmit()">Submit</button>
            </div>
            <div class="mini" id="quizOut"></div>
          </div>
        </div>

        <div class="row" style="margin-top:14px;">
          <div class="card soft">
            <h3 style="margin:0 0 6px;">Memory Match (œÄ facts)</h3>
            <div id="memoryGrid" style="display:grid; grid-template-columns: repeat(4, 1fr); gap:10px;"></div>
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="btn" onclick="memoryStart()">Shuffle / Restart</button>
            </div>
            <div class="mini" id="memoryOut"></div>
          </div>

          <div class="card soft">
            <h3 style="margin:0 0 6px;">Want more games?</h3>
            <p class="subhead" style="margin-top:0;">Tell me the vibe and I‚Äôll add it: speedrun, puzzle, audio, anything.</p>
            <button class="btn" onclick="toast('Message me the game idea, and I‚Äôll implement it ‚ú®')">Suggest a new game</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    const views = ["home","what","calculate","apps","shapes","papers","games"];
    let historyStack = ["home"];

    function go(name){
      if(!views.includes(name)) name = "home";
      document.querySelectorAll(".view").forEach(v => v.classList.remove("active"));
      document.getElementById("view-" + name).classList.add("active");
      if(historyStack[historyStack.length-1] !== name) historyStack.push(name);

      if(name === "calculate") mcDrawFrame(true);
      if(name === "apps") { drawWave(true); drawUnit(); }
      if(name === "shapes") drawCurve();
      if(name === "papers") { document.getElementById("genDate").textContent = new Date().toLocaleString(); loadNotes(); }
      if(name === "games") { quizStart(); memoryStart(); sprintNew(true); }
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    window.addEventListener("keydown", (e) => {
      if(e.altKey && e.key === "ArrowLeft") {
        e.preventDefault();
        if(historyStack.length > 1) {
          historyStack.pop();
          go(historyStack[historyStack.length-1]);
        }
      }
    });

    let toastTimer = null;
    function toast(msg){
      const el = document.getElementById("toast");
      el.textContent = msg;
      el.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => el.classList.remove("show"), 1700);
    }

    function safeEval(expr){
      const cleaned = (expr || "").toLowerCase().replaceAll("œÄ","pi").replaceAll(" ", "");
      if(!cleaned) throw new Error("Empty expression.");
      if(!/^[0-9\.+\-*/()pie]*$/.test(cleaned)) throw new Error("Only numbers, + - * / ( ), pi, e are allowed.");
      const js = cleaned.replaceAll("pi", `(${Math.PI})`).replaceAll("e", `(${Math.E})`);
      return Function("return " + js)();
    }

    function insertPi(){
      const el = document.getElementById("quickExpr");
      el.value = (el.value ? el.value + " * " : "") + "pi";
      el.focus();
    }
    function quickCalc(){
      try {
        const val = safeEval(document.getElementById("quickExpr").value);
        toast("Result: " + val);
      } catch(err) {
        toast(err.message || "Error");
      }
    }

    const digitsText = document.getElementById("digitsBox").textContent.trim();
    function copyDigits(){
      navigator.clipboard.writeText(digitsText).then(()=>toast("Digits copied üìã")).catch(()=>toast("Copy failed"));
    }
    function highlightDigits(){
      const pattern = (document.getElementById("digitSearch").value || "").trim();
      const out = document.getElementById("digitSearchResult");
      if(!pattern) { out.textContent = "Type a pattern first."; return; }
      const idx = digitsText.indexOf(pattern);
      out.textContent = idx === -1 ? "Not found in this chunk." : `Found at position ${idx} (0-indexed, includes '3.').`;
    }

    function calcFromCircle(){
      const r = parseFloat(document.getElementById("rIn").value);
      const c = parseFloat(document.getElementById("cIn").value);
      const out = document.getElementById("circleOut");
      if(!(r>0) || !isFinite(c)) { out.textContent = "Please enter valid r > 0 and numeric C."; return; }
      const est = c / (2*r);
      const err = Math.abs(est - Math.PI);
      out.textContent = `œÄ ‚âà ${est}\nerror ‚âà ${err}\nrelative error ‚âà ${(err/Math.PI)}`;
    }
    function fillPerfectCircle(){
      const r = parseFloat(document.getElementById("rIn").value);
      if(!(r>0)) { toast("Radius must be > 0"); return; }
      document.getElementById("cIn").value = (2*Math.PI*r).toString();
      calcFromCircle();
    }

    const mc = { inside: 0, total: 0, points: [] };
    const mcCanvas = document.getElementById("mcCanvas");
    const mctx = mcCanvas.getContext("2d");
    function mcReset(){
      mc.inside = 0; mc.total = 0; mc.points = [];
      mcDrawFrame(true);
      document.getElementById("mcOut").textContent = "";
      toast("Reset");
    }
    function mcRun(){
      const N = Math.max(1, parseInt(document.getElementById("mcN").value || "1000", 10));
      for(let i=0;i<N;i++){
        const x = Math.random(), y = Math.random();
        const inside = (x*x + y*y) <= 1;
        mc.total += 1;
        mc.inside += inside ? 1 : 0;
        mc.points.push({x,y,inside});
      }
      const est = 4 * (mc.inside / mc.total);
      const err = Math.abs(est - Math.PI);
      document.getElementById("mcOut").textContent = `total=${mc.total}, inside=${mc.inside} ‚Üí œÄ‚âà${est.toFixed(8)} (error‚âà${err.toFixed(8)})`;
      mcDrawFrame();
    }
    function mcDrawFrame(forceClear=false){
      const w = mcCanvas.width, h = mcCanvas.height;
      mctx.clearRect(0,0,w,h);
      mctx.strokeStyle = "rgba(255,255,255,0.18)";
      mctx.lineWidth = 2;
      mctx.strokeRect(20, 20, h-40, h-40);

      mctx.beginPath();
      const cx = 20, cy = h-20, R = h-40;
      mctx.arc(cx, cy, R, -Math.PI/2, 0, false);
      mctx.strokeStyle = "rgba(168,85,247,0.65)";
      mctx.lineWidth = 4;
      mctx.stroke();

      const max = 4000;
      const start = Math.max(0, mc.points.length - max);
      for(let i=start;i<mc.points.length;i++){
        const p = mc.points[i];
        const px = 20 + p.x * (h-40);
        const py = 20 + (1 - p.y) * (h-40);
        mctx.fillStyle = p.inside ? "rgba(52,211,153,0.75)" : "rgba(251,113,133,0.6)";
        mctx.fillRect(px, py, 2, 2);
      }
    }

    let leibTimer = null;
    function leibCompute(){
      const terms = Math.max(1, parseInt(document.getElementById("leibTerms").value || "10000", 10));
      let sum = 0;
      for(let k=0;k<terms;k++) sum += (k%2===0 ? 1 : -1) / (2*k+1);
      const est = 4*sum;
      document.getElementById("leibOut").textContent = `terms=${terms}\nœÄ‚âà${est}\nerror‚âà${Math.abs(est - Math.PI)}`;
    }
    function leibAuto(){
      clearInterval(leibTimer);
      let t = Math.max(1, parseInt(document.getElementById("leibTerms").value || "1000", 10));
      leibTimer = setInterval(() => {
        t = Math.floor(t * 1.6) + 1;
        document.getElementById("leibTerms").value = t;
        leibCompute();
        if(t > 250000) { clearInterval(leibTimer); toast("Auto stopped."); }
      }, 700);
    }

    function calcInsert(id){
      const el = document.getElementById(id);
      el.value = (el.value || "") + "pi";
      el.focus();
    }
    function calcClear(){
      document.getElementById("calcExpr").value = "";
      document.getElementById("calcOut").textContent = "result = ...";
    }
    function calcEval(){
      try {
        const expr = document.getElementById("calcExpr").value;
        const val = safeEval(expr);
        document.getElementById("calcOut").textContent = "result = " + val;
      } catch(err) {
        document.getElementById("calcOut").textContent = "Error: " + (err.message || "invalid expression");
      }
    }

    const waveCanvas = document.getElementById("waveCanvas");
    const wctx = waveCanvas.getContext("2d");
    let waveT = 0, wavePlaying = true;
    function toggleWave(){ wavePlaying = !wavePlaying; toast(wavePlaying ? "Play" : "Pause"); }
    function drawWave(force=false){
      const w = waveCanvas.width, h = waveCanvas.height;
      wctx.clearRect(0,0,w,h);
      wctx.strokeStyle = "rgba(255,255,255,0.14)";
      wctx.lineWidth = 2;
      wctx.beginPath(); wctx.moveTo(20, h/2); wctx.lineTo(w-20, h/2); wctx.stroke();

      const amp = 70, freq = 1.3;
      wctx.beginPath();
      for(let i=0;i<=w-40;i++){
        const x = 20 + i;
        const phase = (i/(w-40)) * (2*Math.PI*freq) + waveT;
        const y = h/2 - amp * Math.sin(phase);
        if(i===0) wctx.moveTo(x,y); else wctx.lineTo(x,y);
      }
      wctx.strokeStyle = "rgba(168,85,247,0.85)";
      wctx.lineWidth = 5;
      wctx.stroke();

      wctx.fillStyle = "rgba(255,255,255,0.72)";
      wctx.font = "14px ui-monospace";
      wctx.fillText("One full cycle = 2œÄ radians", 24, 30);
    }
    function waveLoop(){
      if(wavePlaying) waveT += 0.035;
      if(document.getElementById("view-apps").classList.contains("active")) drawWave();
      requestAnimationFrame(waveLoop);
    }
    requestAnimationFrame(waveLoop);

    const unitCanvas = document.getElementById("unitCanvas");
    const uctx = unitCanvas.getContext("2d");
    function drawUnit(){
      const w = unitCanvas.width, h = unitCanvas.height;
      uctx.clearRect(0,0,w,h);
      const cx = w/2, cy = h/2, R = Math.min(w,h)*0.34;

      uctx.strokeStyle = "rgba(255,255,255,0.22)";
      uctx.lineWidth = 2;
      uctx.beginPath();
      uctx.moveTo(20, cy); uctx.lineTo(w-20, cy);
      uctx.moveTo(cx, 20); uctx.lineTo(cx, h-20);
      uctx.stroke();

      uctx.beginPath();
      uctx.arc(cx, cy, R, 0, 2*Math.PI);
      uctx.strokeStyle = "rgba(255,255,255,0.35)";
      uctx.lineWidth = 4;
      uctx.stroke();

      const theta = parseFloat(document.getElementById("angleSlider").value);
      const x = cx + R*Math.cos(theta);
      const y = cy - R*Math.sin(theta);

      uctx.beginPath();
      uctx.arc(cx, cy, R*0.35, 0, -theta, theta < 0);
      uctx.strokeStyle = "rgba(244,114,182,0.8)";
      uctx.lineWidth = 6;
      uctx.stroke();

      uctx.beginPath();
      uctx.moveTo(cx, cy); uctx.lineTo(x,y);
      uctx.strokeStyle = "rgba(168,85,247,0.9)";
      uctx.lineWidth = 6;
      uctx.stroke();

      uctx.fillStyle = "rgba(168,85,247,0.95)";
      uctx.beginPath(); uctx.arc(x,y,7,0,2*Math.PI); uctx.fill();

      const frac = theta/Math.PI;
      document.getElementById("angleReadout").textContent = `Œ∏‚âà${theta.toFixed(3)} rad (‚âà ${(frac).toFixed(3)}¬∑œÄ)`;
    }
    document.getElementById("angleSlider").addEventListener("input", drawUnit);

    const shapeCanvas = document.getElementById("shapeCanvas");
    const sctx = shapeCanvas.getContext("2d");
    function drawCurve(){
      const curve = document.getElementById("curveSelect").value;
      const k = parseInt(document.getElementById("curveParam").value, 10);
      const delta = parseFloat(document.getElementById("curvePhase").value);

      document.getElementById("curveParamReadout").textContent = `parameter = ${k}`;
      document.getElementById("curvePhaseReadout").textContent = `Œ¥‚âà${delta.toFixed(3)} rad (‚âà ${(delta/Math.PI).toFixed(3)}¬∑œÄ)`;

      const w = shapeCanvas.width, h = shapeCanvas.height;
      sctx.clearRect(0,0,w,h);

      sctx.strokeStyle = "rgba(255,255,255,0.12)";
      sctx.lineWidth = 2;
      sctx.beginPath();
      sctx.moveTo(20, h/2); sctx.lineTo(w-20, h/2);
      sctx.moveTo(w/2, 20); sctx.lineTo(w/2, h-20);
      sctx.stroke();

      const cx = w/2, cy = h/2;
      const scale = Math.min(w,h) * 0.33;
      const toX = (x) => cx + x*scale;
      const toY = (y) => cy - y*scale;

      sctx.beginPath();
      const N = 2200;
      for(let i=0;i<=N;i++){
        const t = (i/N) * (2*Math.PI);
        let x=0,y=0;

        if(curve === "circle"){ x = Math.cos(t); y = Math.sin(t); }
        else if(curve === "archSpiral"){
          const a = 0.08; const r = a * t * (k/4);
          x = r*Math.cos(t); y = r*Math.sin(t);
        }
        else if(curve === "rose"){
          const r = Math.cos(k*t);
          x = r*Math.cos(t); y = r*Math.sin(t);
        }
        else if(curve === "lissajous"){
          const a = k; const b = Math.max(1, Math.round(k*0.6));
          x = Math.sin(a*t); y = Math.sin(b*t + delta);
        }
        else if(curve === "cycloid"){
          x = (t - Math.sin(t)) / (2*Math.PI) * 2.6 - 1.3;
          y = (1 - Math.cos(t)) * 0.75 - 0.5;
        }

        const px = toX(x), py = toY(y);
        if(i===0) sctx.moveTo(px,py); else sctx.lineTo(px,py);
      }
      sctx.strokeStyle = "rgba(168,85,247,0.9)";
      sctx.lineWidth = 5;
      sctx.stroke();
    }

    const NOTES_KEY = "pi_site_notes_v1";
    function saveNotes(){
      localStorage.setItem(NOTES_KEY, document.getElementById("paperNotes").value || "");
      toast("Notes saved");
    }
    function loadNotes(){ document.getElementById("paperNotes").value = localStorage.getItem(NOTES_KEY) || ""; }
    function clearNotes(){ document.getElementById("paperNotes").value = ""; localStorage.removeItem(NOTES_KEY); toast("Cleared"); }

    const sprintChunks = [
      "14159265358979323846264338327950288419716939937510",
      "58209749445923078164062862089986280348253421170679",
      "82148086513282306647093844609550582231725359408128",
      "48111745028410270193852110555964462294895493038196",
      "44288109756659334461284756482337867831652712019091"
    ];
    let sprintTarget = sprintChunks[0];
    let sprintBest = parseInt(localStorage.getItem("pi_sprint_best") || "0", 10);
    function sprintNew(silent=false){
      sprintTarget = sprintChunks[Math.floor(Math.random()*sprintChunks.length)];
      document.getElementById("sprintTarget").textContent = sprintTarget.slice(0, 20) + "‚Ä¶";
      sprintReset(true);
      if(!silent) toast("New target chunk");
    }
    function sprintReset(silent=false){
      document.getElementById("sprintIn").value = "";
      document.getElementById("sprintScore").textContent = "0";
      document.getElementById("sprintBest").textContent = String(sprintBest);
      document.getElementById("sprintStatus").textContent = "üôÇ";
      if(!silent) toast("Reset");
    }
    function sprintCheck(){
      const typed = document.getElementById("sprintIn").value.replace(/\s/g,"");
      let ok = 0;
      for(let i=0;i<typed.length;i++){ if(typed[i] === sprintTarget[i]) ok++; else break; }
      document.getElementById("sprintScore").textContent = String(ok);
      if(typed.length === 0) { document.getElementById("sprintStatus").textContent = "üôÇ"; return; }
      document.getElementById("sprintStatus").textContent = (ok === typed.length) ? "‚úÖ" : "‚ùå";
      if(ok > sprintBest){
        sprintBest = ok;
        localStorage.setItem("pi_sprint_best", String(sprintBest));
        document.getElementById("sprintBest").textContent = String(sprintBest);
      }
    }

    const quizQs = [
      { q: "œÄ is defined as:", a: ["C / d (circumference divided by diameter)", "A / r", "d / C", "2r / C"], correct: 0 },
      { q: "One full turn in radians equals:", a: ["œÄ", "2œÄ", "œÄ/2", "4œÄ"], correct: 1 },
      { q: "Which is true about œÄ?", a: ["It is rational", "Repeating decimal", "It is irrational", "It is an integer"], correct: 2 },
      { q: "A quick approximation of œÄ is:", a: ["3/2", "22/7", "7/22", "2.718"], correct: 1 },
      { q: "Euler‚Äôs identity includes:", a: ["e^(iœÄ) + 1 = 0", "œÄ^2 = 2", "e^œÄ = 0", "i^2 = 1"], correct: 0 },
    ];
    let quizState = [];
    function quizStart(){ quizState = quizQs.map(()=>({pick:-1})); renderQuiz(); document.getElementById("quizOut").textContent = ""; }
    function renderQuiz(){
      const box = document.getElementById("quizBox");
      box.innerHTML = "";
      quizQs.forEach((item, idx) => {
        const div = document.createElement("div");
        div.style.marginBottom = "12px";
        const title = document.createElement("div");
        title.textContent = (idx+1) + ". " + item.q;
        title.style.marginBottom = "6px";
        div.appendChild(title);

        item.a.forEach((choice, cidx) => {
          const label = document.createElement("label");
          label.style.display = "flex";
          label.style.gap = "10px";
          label.style.alignItems = "center";
          label.style.margin = "6px 0";
          label.style.cursor = "pointer";
          label.style.color = "rgba(255,255,255,0.82)";
          label.style.fontFamily = "ui-monospace";
          const input = document.createElement("input");
          input.type = "radio";
          input.name = "q" + idx;
          input.checked = (quizState[idx].pick === cidx);
          input.addEventListener("change", () => { quizState[idx].pick = cidx; });
          label.appendChild(input);
          const span = document.createElement("span");
          span.textContent = choice;
          label.appendChild(span);
          div.appendChild(label);
        });
        box.appendChild(div);
      });
    }
    function quizSubmit(){
      let score = 0;
      quizQs.forEach((q, i) => { if(quizState[i].pick === q.correct) score++; });
      document.getElementById("quizOut").textContent = `Score: ${score}/${quizQs.length}`;
      toast(score === quizQs.length ? "Perfect! üü£" : "Submitted");
    }

    const memoryPairs = [
      ["œÄ", "C/d for circles"],
      ["œÑ", "2œÄ (one turn)"],
      ["radians", "angles measured with œÄ"],
      ["Monte Carlo", "œÄ ‚âà 4¬∑inside/total"],
      ["Euler", "e^(iœÄ)+1=0"],
      ["Area", "œÄ¬∑r¬≤"]
    ];
    let memoryCards = [], memoryFirst = null, memoryLock = false, memoryMatches = 0;
    function memoryStart(){
      memoryMatches = 0; memoryFirst = null; memoryLock = false; memoryCards = [];
      memoryPairs.forEach(([a,b]) => {
        memoryCards.push({text:a, key:a, face:false, matched:false});
        memoryCards.push({text:b, key:a, face:false, matched:false});
      });
      for(let i=memoryCards.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [memoryCards[i], memoryCards[j]] = [memoryCards[j], memoryCards[i]];
      }
      renderMemory();
      document.getElementById("memoryOut").textContent = "Find all pairs.";
      toast("Shuffled");
    }
    function renderMemory(){
      const grid = document.getElementById("memoryGrid");
      grid.innerHTML = "";
      grid.style.gridTemplateColumns = window.innerWidth < 560 ? "repeat(2, 1fr)" : "repeat(4, 1fr)";
      memoryCards.forEach((card, idx) => {
        const btn = document.createElement("button");
        btn.className = "btn";
        btn.style.borderRadius = "18px";
        btn.style.padding = "14px";
        btn.style.height = "70px";
        btn.style.textAlign = "left";
        btn.style.fontFamily = "ui-monospace";
        btn.style.whiteSpace = "nowrap";
        btn.style.overflow = "hidden";
        btn.style.textOverflow = "ellipsis";
        btn.disabled = card.matched || memoryLock;
        btn.textContent = (card.face || card.matched) ? card.text : "‚ñ¢ ‚ñ¢ ‚ñ¢";
        if(card.matched){
          btn.style.background = "rgba(52,211,153,0.18)";
          btn.style.borderColor = "rgba(52,211,153,0.28)";
        }
        btn.onclick = () => memoryFlip(idx);
        grid.appendChild(btn);
      });
    }
    function memoryFlip(idx){
      const card = memoryCards[idx];
      if(card.matched || card.face || memoryLock) return;
      card.face = true;
      renderMemory();
      if(memoryFirst === null){ memoryFirst = idx; return; }
      const first = memoryCards[memoryFirst];
      if(first.key === card.key && memoryFirst !== idx){
        first.matched = true; card.matched = true;
        memoryMatches++; memoryFirst = null;
        renderMemory();
        document.getElementById("memoryOut").textContent = `Matches: ${memoryMatches}/${memoryPairs.length}`;
        if(memoryMatches === memoryPairs.length) toast("All matched! üéâ");
      } else {
        memoryLock = true;
        setTimeout(() => {
          first.face = false; card.face = false;
          memoryFirst = null; memoryLock = false;
          renderMemory();
        }, 650);
      }
    }

    document.getElementById("kpiErr").textContent = "‚âà " + Math.abs((22/7) - Math.PI).toFixed(8);
    document.getElementById("kpiTau").textContent = (2*Math.PI).toFixed(14);

    mcDrawFrame(true);
    drawWave(true);
    drawUnit();
    drawCurve();
    quizStart();
    memoryStart();
    sprintNew(true);
    document.getElementById("genDate").textContent = new Date().toLocaleString();
  </script>
</body>
</html>
